# 1
#(d)
my.datafile <- tempfile()
cat(file=my.datafile, "
    1967 105000 16300 1.25 547.9
    1968 105000 15800 1.34 593.4
    1969 121600 16000 1.22 638.9
    1970 113750 14200 1.00 695.3
    1971 113750 15000 1.15 751.8
    1972 128925 14000 1.13 810.3
    1973 142500 15400 1.05 914.5
    1974 126000 18250 1.27 998.3
    1975 162000 17300 1.07 1096.1
    1976 191625 23000 1.17 1194.4
    1977 189000 19300 1.07 1311.5
    1978 210000 23056 1.54 1462.9
    1979 224250 26000 1.59 1641.7
    1980 245000 28000 1.56 1821.7
    ", sep=" ")

data <- read.table(my.datafile, header=FALSE, col.names=c("year","y", "x1", "x2", "x3")) 
attach(data)
r<-sum((x3-mean(x3))*(y-mean(y)))/((sum((x3-mean(x3))^2)*sum((y-mean(y))^2))^0.5)
r
n<-length(y)
a<-0.5*log((1+r)/(1-r))+qnorm(0.95)/sqrt(n-3)       
b<-0.5*log((1+r)/(1-r))-qnorm(0.95)/sqrt(n-3) 
uu<-(exp(2*a)-1)/(exp(2*a)+1)
dd<-(exp(2*b)-1)/(exp(2*b)+1)
uu
dd


# 2
y2<-c(1,6,1,7,8)
x<-matrix(c(1,1,1,1,1,1.5,2,1,0.5,2),ncol=2)
x
x0<-c(1,2.1)
#(a)
solve(t(x)%*%x)%*%t(x)%*%y2
#(b)
t(x0)%*%solve(t(x)%*%x)%*%x0
